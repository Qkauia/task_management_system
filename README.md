## QTakes
[é»æ“Šé€²å…¥ç¶²ç«™ ğŸŒ](https://taskmanagementsystem.fly.dev/zh-TW/)

# Project Overview

è©²å°ˆæ¡ˆæ˜¯ä¸€å€‹ä»»å‹™ç®¡ç†ç³»çµ±ï¼Œå…è¨±ä½¿ç”¨è€…å»ºç«‹ã€ç®¡ç†å’Œåˆ†é¡ä»–å€‘çš„ä»»å‹™ï¼Œä¸¦æ”¯æ´ç¾¤çµ„åŠŸèƒ½å’Œé€šçŸ¥ç³»çµ±ã€‚

### ä¸»è¦åŠŸèƒ½

- **ä½¿ç”¨è€…ç®¡ç†**ï¼š
  - è¨»å†Šã€ç™»å…¥å’Œç™»å‡º
  - ä¸Šå‚³å¤§é ­ç…§
  - æ›´æ”¹å¯†ç¢¼
  - **ç®¡ç†å“¡è§’è‰²**ï¼š
    - æœå°‹ä½¿ç”¨è€…
    - æ›´æ”¹ä½¿ç”¨è€…æ¬Šé™
    - åˆªé™¤ä½¿ç”¨è€…

- **ä¸Šå‚³æª”æ¡ˆ**ï¼š
  - æ”¯æ´ Amazon S3

- **ä»»å‹™ç®¡ç†**ï¼š
  - ä»»å‹™æœå°‹ã€ç¯©é¸èˆ‡æ’åˆ—
  - æŸ¥çœ‹æ¨™è¨˜ä½¿ç”¨é‡ï¼ˆåœ–è¡¨ï¼‰
  - ä»»å‹™åˆ†äº«åŠŸèƒ½ï¼š
    - åˆ†äº«çµ¦ä½¿ç”¨è€…
    - åˆ†äº«è‡³ç¾¤çµ„
  - ä»»å‹™è‡ªå‹•æ’ç¨‹è‡³æ—¥æ›†é¡¯ç¤º
  - ä»»å‹™åˆ—è¡¨ä»‹é¢æ”¯æ´æ‹–æ”¾æ“ä½œ
  - ä»»å‹™åˆ°æœŸé€šçŸ¥

- **ä»‹é¢èªè¨€æ”¯æ´**ï¼š
  - ä¸­æ–‡/è‹±æ–‡
  - RWD éŸ¿æ‡‰å¼è¨­è¨ˆ

### ä½¿ç”¨æŠ€è¡“

#### å‰ç«¯æŠ€è¡“

- **Bootstrap**
- **Stimulus**

#### å¾Œç«¯æŠ€è¡“

- **Ruby**
- **Ruby on Rails**

#### éƒ¨ç½²å’ŒåŸ·è¡Œç’°å¢ƒ

- **Fly.io**
- **AWS**

#### ç‰ˆæœ¬æ§åˆ¶å’Œä»£ç¢¼å­˜å„²

- **Git**
- **GitHub**

#### è³‡æ–™åº«

- **PostgreSQL**

## Installation Guide
1. Clone the project locally:
    ```bash
    git clone git@github.com:Qkauia/task_management_system.git
    cd task-manager
    ```
2. Install dependencies:
    ```bash
    bundle install
    yarn install
    ```
3. Set up the database:
    ```bash
    rails db:create
    rails db:migrate
    ```
4. Seed the database:
    ```bash
    rails db:seed
    ```
5. Start the server:
    ```bash
    bin/dev
    ```

## Database Structure

### Extensions
æ­¤å°ˆæ¡ˆä½¿ç”¨ä»¥ä¸‹ PostgreSQL æ“´å……åŠŸèƒ½ï¼š
- `plpgsql`ï¼šæ”¯æ´ PostgreSQL çš„ç¨‹åºåŒ–èªè¨€ã€‚

### Tables

#### `groups`
| æ¬„ä½åç¨±    | è³‡æ–™é¡å‹  | èªªæ˜                                |
|-------------|-----------|-------------------------------------|
| `id`        | `bigint`  | ä¸»éµã€‚                              |
| `name`      | `string`  | ç¾¤çµ„åç¨±ã€‚                          |
| `user_id`   | `integer` | å»ºç«‹è€…ï¼ˆç¾¤çµ„é ˜è¢–ï¼‰ã€‚                |
| `deleted_at`| `datetime`| è»Ÿåˆªé™¤æ™‚é–“æˆ³è¨˜ã€‚                    |
| `created_at`| `datetime`| è¨˜éŒ„å»ºç«‹çš„æ™‚é–“æˆ³è¨˜ã€‚                |
| `updated_at`| `datetime`| è¨˜éŒ„æœ€å¾Œæ›´æ–°çš„æ™‚é–“æˆ³è¨˜ã€‚            |

#### `group_users`
| æ¬„ä½åç¨±    | è³‡æ–™é¡å‹                  | èªªæ˜                                |
|-------------|---------------------------|-------------------------------------|
| `group_id`  | `bigint` (å¤–éµ)           | åƒè€ƒ `groups` è¡¨ã€‚                  |
| `user_id`   | `bigint` (å¤–éµ)           | åƒè€ƒ `users` è¡¨ã€‚                   |
| `created_at`| `datetime`                | è¨˜éŒ„å»ºç«‹çš„æ™‚é–“æˆ³è¨˜ã€‚                |
| `updated_at`| `datetime`                | è¨˜éŒ„æœ€å¾Œæ›´æ–°çš„æ™‚é–“æˆ³è¨˜ã€‚            |

**ç´¢å¼•:**
- `index_group_users_on_group_id`
- `index_group_users_on_user_id`

**é—œè¯:**
- `belongs_to :group`
- `belongs_to :user`

#### `group_tasks`
| æ¬„ä½åç¨±    | è³‡æ–™é¡å‹                  | èªªæ˜                                |
|-------------|---------------------------|-------------------------------------|
| `group_id`  | `bigint` (å¤–éµ)           | åƒè€ƒ `groups` è¡¨ã€‚                  |
| `task_id`   | `bigint` (å¤–éµ)           | åƒè€ƒ `tasks` è¡¨ã€‚                   |
| `created_at`| `datetime`                | è¨˜éŒ„å»ºç«‹çš„æ™‚é–“æˆ³è¨˜ã€‚                |
| `updated_at`| `datetime`                | è¨˜éŒ„æœ€å¾Œæ›´æ–°çš„æ™‚é–“æˆ³è¨˜ã€‚            |

**ç´¢å¼•:**
- `index_group_tasks_on_group_id`
- `index_group_tasks_on_task_id`

**é—œè¯:**
- `belongs_to :group`
- `belongs_to :task`

#### `tasks`
| æ¬„ä½åç¨±    | è³‡æ–™é¡å‹                  | èªªæ˜                                |
|-------------|---------------------------|-------------------------------------|
| `title`     | `string`                  | ä»»å‹™æ¨™é¡Œã€‚                          |
| `content`   | `text`                    | ä»»å‹™å…§å®¹ã€‚                          |
| `start_time`| `datetime`                | ä»»å‹™é–‹å§‹æ™‚é–“ã€‚                      |
| `end_time`  | `datetime`                | ä»»å‹™çµæŸæ™‚é–“ã€‚                      |
| `priority`  | `integer` (é è¨­å€¼: 1, ä¸å¯ç‚ºç©º) | ä»»å‹™å„ªå…ˆç´š (1: ä½, 2: ä¸­, 3: é«˜)ã€‚ |
| `status`    | `integer` (é è¨­å€¼: 1, ä¸å¯ç‚ºç©º) | ä»»å‹™ç‹€æ…‹ (1: å¾…è™•ç†, 2: é€²è¡Œä¸­, 3: å·²å®Œæˆ)ã€‚ |
| `position`  | `integer`                 | ä»»å‹™æ’åºä½ç½®ã€‚                      |
| `important` | `boolean`                 | æ˜¯å¦æ¨™è¨˜ç‚ºé‡è¦ä»»å‹™ (true: é‡è¦, false: ä¸é‡è¦)ã€‚|
| `user_id`   | `bigint` (å¤–éµ)           | åƒè€ƒ `users` è¡¨ã€‚                   |
| `deleted_at`| `datetime`                | è»Ÿåˆªé™¤æ™‚é–“æˆ³è¨˜ã€‚                    |
| `created_at`| `datetime`                | è¨˜éŒ„å»ºç«‹çš„æ™‚é–“æˆ³è¨˜ã€‚                |
| `updated_at`| `datetime`                | è¨˜éŒ„æœ€å¾Œæ›´æ–°çš„æ™‚é–“æˆ³è¨˜ã€‚            |

**ç´¢å¼•:**
- `index_tasks_on_deleted_at`
- `index_tasks_on_user_id`

#### `users`
| æ¬„ä½åç¨±    | è³‡æ–™é¡å‹                  | èªªæ˜                                |
|-------------|---------------------------|-------------------------------------|
| `email`     | `string` (é è¨­å€¼: "", ä¸å¯ç‚ºç©º) | ä½¿ç”¨è€…é›»å­éƒµä»¶åœ°å€ (å¿…é ˆå”¯ä¸€)ã€‚    |
| `password_hash` | `string` (ä¸å¯ç‚ºç©º)    | å¯†ç¢¼çš„å“ˆå¸Œå€¼ã€‚                      |
| `password_salt` | `string` (ä¸å¯ç‚ºç©º)    | å¯†ç¢¼é¹½å€¼ã€‚                          |
| `role`      | `string`                  | ä½¿ç”¨è€…è§’è‰² (ä¾‹å¦‚ï¼šç®¡ç†å“¡ã€æ™®é€šç”¨æˆ¶)ã€‚|
| `avatar`    | `string`                  | ä½¿ç”¨è€…é ­åƒçš„è·¯å¾‘ã€‚                  |
| `deleted_at`| `datetime`                | è»Ÿåˆªé™¤æ™‚é–“æˆ³è¨˜ã€‚                    |
| `created_at`| `datetime`                | è¨˜éŒ„å»ºç«‹çš„æ™‚é–“æˆ³è¨˜ã€‚                |
| `updated_at`| `datetime`                | è¨˜éŒ„æœ€å¾Œæ›´æ–°çš„æ™‚é–“æˆ³è¨˜ã€‚            |

**ç´¢å¼•:**
- `index_users_on_deleted_at`
- `index_users_on_email` (å”¯ä¸€)

### å¤–éµ
- `group_tasks`: `group_id`, `task_id`
- `group_users`: `group_id`, `user_id`
- `tasks`: `user_id`
- `notifications`: `user_id`, `task_id`
- `task_tags`: `task_id`, `tag_id`
- `task_users`: `task_id`, `user_id`


## éƒ¨å±¬æµç¨‹

é¦–å…ˆ Fly.io æ”¯æ´ Dockerfile éƒ¨å±¬ï¼Œæ‰€ä»¥æˆ‘å…ˆå»ºç«‹ Dockerfile å’Œ Docker Composeï¼Œä¸¦å˜—è©¦åœ¨ Docker ä¸­é‹è¡Œã€‚

1. **è¨»å†Š Fly.io å¸³è™Ÿä¸¦ç™»å…¥**ï¼š
   - ä½¿ç”¨ `$flyctl auth login` è¨»å†Šä¸¦ç™»å…¥ Fly.io å¸³è™Ÿï¼Œä¸¦ä¸”é€²è¡Œèº«ä»½èªè­‰ï¼ˆéœ€è¦æä¾›ä¿¡ç”¨å¡ä¿¡æ¯ï¼‰ã€‚

2. **åˆå§‹åŒ–æ‡‰ç”¨**ï¼š
   - ä½¿ç”¨ `$flyctl launch` é€²å…¥åˆå§‹åŒ–è¨­å®šã€‚
     - **æ‡‰ç”¨ç¨‹å¼å**ï¼šFly.io æœƒæ ¹æ“šç•¶å‰ç›®éŒ„åç¨±è‡ªå‹•ç¶å®šæ‡‰ç”¨åç¨±ï¼Œä¹Ÿå¯ä»¥æ‰‹å‹•ä¿®æ”¹ã€‚
     - **éƒ¨å±¬å€åŸŸ**ï¼šFly.io æœƒæ ¹æ“šä½ç½®æ¨è–¦æœ€è¿‘çš„ä¼ºæœå™¨å€åŸŸï¼ˆæ•ˆèƒ½å¯èƒ½ä¾æ“šè·é›¢æ±ºå®šï¼‰ã€‚
     - **PostgreSQL è³‡æ–™åº«é…ç½®**ï¼šé€é Fly.io å‰µå»ºä¸¦ç¶å®šè³‡æ–™åº«ï¼Œå¯å®¢è£½é¸æ“‡è³‡æ–™åº«è¦æ ¼ã€‚
     - **Redis é…ç½®ï¼ˆå¯é¸ï¼‰**ï¼šå¯é¸æ“‡æ˜¯å¦é…ç½® Redisã€‚

   - **Fly.io æœƒç”Ÿæˆé…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­ `fly.toml` éå¸¸é‡è¦**ï¼š
     - `fly.toml` é€™å€‹æ–‡ä»¶æœƒæ ¹æ“šåˆå§‹åŒ–éç¨‹ç”Ÿæˆï¼Œä½†éƒ¨åˆ†å…§å®¹éœ€è¦æ‰‹å‹•èª¿æ•´ã€‚
     - ä¾‹å¦‚ï¼š
       ```toml
       app = 'taskmanagementsystem'  # Fly.io ä¸Šæ‡‰ç”¨çš„åç¨±ï¼Œé€™æ˜¯æ‡‰ç”¨çš„å”¯ä¸€æ¨™è­˜ç¬¦
       primary_region = 'nrt'  # éƒ¨ç½²æ‡‰ç”¨çš„ä¸»è¦å€åŸŸ
       console_command = '/rails/bin/rails console'  # é è¨­çš„ Rails æ§åˆ¶å°å‘½ä»¤

       [build]
         dockerfile = "./Dockerfile"  # æŒ‡å®š Dockerfile çš„è·¯å¾‘ï¼Œç”¨æ–¼æ§‹å»ºæ‡‰ç”¨çš„ Docker æ˜ åƒ

       [deploy]
         release_command = './bin/rails db:prepare'  # éƒ¨ç½²æ™‚åŸ·è¡Œçš„å‘½ä»¤ï¼Œè³‡æ–™åº«é·ç§»

       [http_service]
         internal_port = 3000  # æ‡‰ç”¨ç¨‹åºå…§éƒ¨ä½¿ç”¨çš„ç«¯å£ï¼Œé€™è£¡æ˜¯ Rails ä¼ºæœå™¨çš„é»˜èªç«¯å£ 3000
         force_https = true  # å¼·åˆ¶ä½¿ç”¨ HTTPS ä¾†è¨ªå•æ‡‰ç”¨ï¼Œç¢ºä¿å®‰å…¨æ€§
         auto_stop_machines = 'stop'  # ç•¶æ‡‰ç”¨ç©ºé–’æ™‚è‡ªå‹•åœæ­¢æ©Ÿå™¨ï¼Œä»¥ç¯€çœè³‡æºå’ŒçœéŒ¢
         auto_start_machines = true  # ç•¶æœ‰è«‹æ±‚é€²ä¾†æ™‚ï¼Œè‡ªå‹•å•Ÿå‹•æ©Ÿå™¨
         min_machines_running = 0  # è¨­ç½®æœ€å°‘é‹è¡Œçš„æ©Ÿå™¨æ•¸é‡ï¼Œé€™è£¡è¨­ç½®ç‚º 0ï¼Œè¡¨ç¤ºåœ¨ç„¡è«‹æ±‚æ™‚æ©Ÿå™¨å¯ä»¥å…¨éƒ¨åœæ­¢
         processes = ['app']  # å®šç¾©æ‡‰ç”¨ç¨‹åºçš„é€²ç¨‹åç¨±ï¼Œé€šå¸¸ç”¨æ–¼æ¨™è¨˜æˆ–å€åˆ†ä¸åŒçš„æœå‹™

       [[vm]]
         memory = '1gb'  # åˆ†é…çµ¦æ¯å€‹ VM çš„å…§å­˜å¤§å°ï¼Œé€™è£¡è¨­ç½®ç‚º 1GB
         cpu_kind = 'shared'  # ä½¿ç”¨å…±äº«çš„ CPU é¡å‹ï¼Œé©åˆå¤§å¤šæ•¸ä¸€èˆ¬ç”¨é€”çš„æ‡‰ç”¨
         cpus = 1  # åˆ†é…çµ¦æ¯å€‹ VM çš„ CPU æ ¸å¿ƒæ•¸é‡ï¼Œé€™è£¡è¨­ç½®ç‚º 1 æ ¸

       [[statics]]
         guest_path = '/rails/public'  # æŒ‡å®šæ‡‰ç”¨ç¨‹åºä¸­éœæ…‹æ–‡ä»¶çš„è·¯å¾‘ï¼Œé€šå¸¸æ˜¯ Rails çš„ public è³‡æ–™å¤¾
         url_prefix = '/'  # éœæ…‹è³‡æºçš„ URL å‰ç¶´ï¼Œé€™è£¡è¨­ç½®ç‚ºæ ¹ç›®éŒ„
       ```

   - **è¨­ç½®ç’°å¢ƒè®Šæ•¸çµ¦ Fly.io**ï¼š
     - ä¾‹å¦‚è¨­ç½® `AWS_ACCESS_KEY_ID` å’Œ `SECRET_KEY_BASE` ç­‰ï¼Œä½¿ç”¨ Fly.io çš„æŒ‡ä»¤è¨­å®šï¼š
     - ç¤ºä¾‹æŒ‡ä»¤ï¼š`$flyctl secrets set AWS_ACCESS_KEY_ID=hello SECRET_KEY_BASE=$(bin/rails secret) ...`

3. **éƒ¨å±¬æ‡‰ç”¨**ï¼š
   - ä½¿ç”¨ `$fly deploy` é€²è¡Œéƒ¨å±¬ã€‚
     - å¦‚æœéƒ¨å±¬å¤±æ•—ï¼Œæœƒé¡¯ç¤ºéŒ¯èª¤è¨Šæ¯ï¼Œä¾‹å¦‚ç¼ºå°‘å¥—ä»¶æˆ–æ˜¯è®Šæ•¸ç­‰ã€‚
     - æ ¹æ“šéŒ¯èª¤è¨Šæ¯é€²è¡Œæ›´æ”¹ä¸¦é‡æ–°éƒ¨å±¬ã€‚
     - éƒ¨å±¬æˆåŠŸå¾Œæœƒé¡¯ç¤ºæ‡‰ç”¨ç¨‹å¼çš„ domainã€‚

4. **æª¢æŸ¥æ‡‰ç”¨ç‹€æ…‹**ï¼š
   - éƒ¨å±¬æˆåŠŸå¾Œï¼Œå¯ä»¥é€²å…¥æ‡‰ç”¨çš„ domain æª¢æŸ¥æ˜¯å¦æœ‰ç•°å¸¸ã€‚
   - ä½¿ç”¨ `$fly logs` æŸ¥çœ‹å¯¦æ™‚æ—¥èªŒï¼Œæˆ–ä½¿ç”¨ `$fly status` æŸ¥çœ‹æ‡‰ç”¨çš„é‹è¡Œç‹€æ…‹ã€‚
